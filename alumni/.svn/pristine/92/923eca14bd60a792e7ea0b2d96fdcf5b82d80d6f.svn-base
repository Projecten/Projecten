<script type="text/javascript">
    var deleteid = 0;
    $(document).ready(function() {
        $(function() {
            $( ".buttons" ).button();
        }); 
    
        $(function(){

            $( "#dialog-delete-fout" ).dialog({
                autoOpen: false,
                resizable: false,
                width: 400,
                height: 200,
                modal: true,
                buttons: {
                    "OK": function() {
                        $( this ).dialog( "close" );
                    }
                }
            });

            // delete dialoog

            $( "#dialog-delete" ).dialog({
                autoOpen: false,
                resizable: false,
                height: 200,
                modal: true,
                buttons: {
                    "Ja": function() {
                        // gegevens verwijderen via ajax
                        $.ajax({
                            type: "GET",
                            url: site_url + "/admin/controleDelete",
                            async: false,
                            data : { id : deleteid },
                            success : function(result){
                                if (result == '0') {
                                    // verwijderen is mislukt, foutmelding tonen
                                    $( "#dialog-delete-fout" ).dialog( "open" );
                                    $( "#dialog-delete" ).dialog( "close" );
                                } else {
                                    location.href = site_url + "/admin/delete/" + deleteid;
                                    $( "#dialog-delete" ).dialog( "close" );
                                }
                            }
                        });
                    },
                    "Neen": function() {
                        $( this ).dialog( "close" );
                    }
                }
            });

            $( ".verwijder" ).click(function(e) {
                e.preventDefault();
                deleteid = $( this ).attr("id").valueOf();
                naam = $( this ).attr("name").valueOf();
                document.getElementById("dialogverwijder").innerHTML = "Het evenement '" + naam + "' wordt verwijderd. Ben je zeker?";
                document.getElementById("dialogverwijder-fout").innerHTML = "Het evenement '" + naam + "' kan niet verwijderd worden omdat er nog alumni ingeschreven zijn voor het evenement.";
                $( "#dialog-delete" ).dialog( "open" );
            });

        });
        
        
        $("#start").click(function(e){
            e.preventDefault();
            aantal = document.getElementById("aantal").value;
            $.ajax({
                type: "GET",
                url: site_url + "/alumnus/evenementBekijken",
                async: false,
                data : { aantal : aantal },
                success : function(result){
                    alert(aantal + " " + site_url + "/alumnus/evenementBekijken");
                }
            });
        });
    });
     
</script>

<div id="dialog-delete" title="Verwijderen">
    <div align="center"><span style="float:left; margin:0px 0px 0px 0px;">
            <img height="50" width="50" src="<?php echo base_url() . APPPATH; ?>css/images/deletedialog.png" />
        </span>
        <span id="dialogverwijder"></span>
    </div>
</div>
<div id="dialog-delete-fout" title="Fout">
    <div align="center"><span style="float:left; margin:0px 0px 0px 0px;">
            <img height="50" width="50" src="<?php echo base_url() . APPPATH; ?>css/images/deletedialog.png" />
        </span>
        <span id="dialogverwijder-fout"></span>
    </div>
</div>

<?php
// lokaal gezet op nederlands zodat de datums hun weekdagen en maanden in het nederlands staanf
setlocale(LC_ALL, 'nl_NL');
?>

<?php
if (count($evenementen) != 0) {
    echo "<table class='fancy sortable'>";
    echo '<colgroup>';
    echo '<col width="250px" />';
    echo '<col width="250px" />';
    echo '<col width="250px" />';
    echo '<col />';
    echo '<col />';
    echo '</colgroup>';
    echo '<tr>';
    echo '<th>Naam</th>\n';
    echo '<th>Datum</th>';
    echo '<th>Plaats</th>';
    if ($recht == 3) {
        echo '<th colspan="2">Beheren</th>';
    } else if ($recht == 1) {
        echo '<th colspan="2">Inschrijven</th>';
    }

//controle op gebruiker en naargelang juiste header tonen
    echo '</tr>';
    foreach ($evenementen as $evenement) {
        echo '<tr>';
        echo '<td>' . divAnchor('alumnus/evenementdetail/' . $evenement->id, $evenement->naam, $id = $evenement->id, $naam = $evenement->naam) . '</td>';
        echo '<td>' . strftime("%A %e %B %Y", strtotime($evenement->begintijd)) . '</td>';
        echo '<td>' . $evenement->plaats->locatie . '</td>';

        //controle op gebruiker en naargelang juiste knop aanbieden
        if ($recht == 3) {
            //Knoppen voor editten en verwijderen
            echo '<td>' . anchor('admin/evenementAanpassen/' . $evenement->id, '<img src="' . base_url() . APPPATH . 'css/images/edit.png"/>') . '</td>';
            echo '<td><a class="verwijder" href="#" id="' . $evenement->id . '" name="' . $evenement->naam . '"><img src="' . base_url() . APPPATH . 'css/images/delete.png"/></a></td>';
        } elseif ($recht == 1) {
            //indien een gewone alumnus => zichzelf kunnen inschrijven
            echo '<td>' . anchor('alumnus/inschrijven/' . $evenement->id, "In- Uitschrijven", "class='buttons'") . '</td>';
        } elseif ($recht == 2) {
            //docenten mogen aanpassen
            echo '<td>' . anchor('admin/evenementAanpassen/' . $evenement->id, '<img src="' . base_url() . APPPATH . 'css/images/edit.png"/>') . '</td>';
        }
        echo '</tr>';
    }
    echo "</table>";

    //Pagination tonen + input aantal records per pagina
    echo form_open("alumnus/evenementenBekijken");
    echo "<table>";
    echo "<tr><td>";
    if (isset($links) && $links != NULL) {
        echo "<p>" . $links . "</p>";
        echo "</td><td>";
    }
    
    //aantal records op pagination aanpassen (in de vakantie)
    //
//    echo form_dropdown("aantal", $options = array("5", "10", "15", "20"));
//    echo "</td><td>";
//    echo form_submit("submit", "Start", "class='buttons'", "name='start'", "id='start'");
//    echo "</tr></td>";
    echo "</table>";
//    echo form_close();
} else {
    echo "<p>Geen resultaten gevonden.</p>";
}
?>