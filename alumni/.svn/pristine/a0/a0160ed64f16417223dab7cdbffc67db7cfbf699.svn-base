<script type="text/javascript">
    var deleteid = 0;
    $(document).ready(function() {
        $(function() {
            $.datepicker.regional[""].dateFormat = 'dd/mm/yy';
            $.datepicker.setDefaults($.datepicker.regional['']);

            $(".buttons").button();


            $("#dialog-delete-fout").dialog({
                autoOpen: false,
                resizable: false,
                width: 400,
                height: 200,
                modal: true,
                buttons: {
                    "OK": function() {
                        $(this).dialog("close");
                    }
                }
            });

            // delete dialoog

            $("#dialog-delete").dialog({
                autoOpen: false,
                resizable: false,
                height: 200,
                modal: true,
                buttons: {
                    "Ja": function() {
                        // gegevens verwijderen via ajax
                        $.ajax({
                            type: "GET",
                            url: site_url + "/admin/controleDelete",
                            async: false,
                            data: {id: deleteid},
                            success: function(result) {
                                if (result == '0') {
                                    // verwijderen is mislukt, foutmelding tonen
                                    $("#dialog-delete-fout").dialog("open");
                                    $("#dialog-delete").dialog("close");
                                } else {
                                    location.href = site_url + "/admin/delete/" + deleteid;
                                    $("#dialog-delete").dialog("close");
                                }
                            }
                        });
                    },
                    "Neen": function() {
                        $(this).dialog("close");
                    }
                }
            });

            $(".verwijder").click(function(e) {
                e.preventDefault();
                deleteid = $(this).attr("id").valueOf();
                naam = $(this).attr("name").valueOf();
                document.getElementById("dialogverwijder").innerHTML = "Het evenement '" + naam + "' wordt verwijderd. Ben je zeker?";
                document.getElementById("dialogverwijder-fout").innerHTML = "Het evenement '" + naam + "' kan niet verwijderd worden omdat er al alumni ingeschreven zijn voor het evenement.";
                $("#dialog-delete").dialog("open");
            });


            $('.datatable').dataTable({
                "oLanguage": {
                    "sLengthMenu": "Laat _MENU_ records per pagina zien",
                    "sZeroRecords": "Niets gevonden - sorry",
                    "sEmptyTable": "Geen records gevonden in de tabel",
                    "sInfo": "_START_ tot _END_ van _TOTAL_  records",
                    "sInfoEmpty": "0 tot 0 van 0 totale records",
                    "sInfoFiltered": "(gefilterd van _MAX_ records)",
                    "sSearch": "Alles zoeken:",
                    "oPaginate": {
                        "sFirst": "<<",
                        "sLast": ">>",
                        "sNext": ">",
                        "sPrevious": "<"
                    }
                },
                //"bJQueryUI": true,
                "sPaginationType": "full_numbers"
            })
                    .columnFilter({
                aoColumns: [
                    {type: "text"},
                    {type: "date-range"},
                    {type: "select"}
                ]
            });

        });
    });



</script>

<div id="dialog-delete" title="Verwijderen">
    <div align="center"><span style="float:left; margin:0px 0px 0px 0px;">
            <img height="50" width="50" src="<?php echo base_url() . APPPATH; ?>css/images/deletedialog.png" />
        </span>
        <span id="dialogverwijder"></span>
    </div>
</div>
<div id="dialog-delete-fout" title="Fout">
    <div align="center"><span style="float:left; margin:0px 0px 0px 0px;">
            <img height="50" width="50" src="<?php echo base_url() . APPPATH; ?>css/images/deletedialog.png" />
        </span>
        <span id="dialogverwijder-fout"></span>
    </div>
</div>

<?php
// lokaal gezet op nederlands zodat de datums hun weekdagen en maanden in het nederlands staanf
setlocale(LC_ALL, 'nl_NL');
?>

<?php
echo '<h1>Evenementen</h1>';
echo '<table class="datatable">';
echo '<thead>';
echo '<tr>';
echo '<th>Naam</th>';
echo '<th>Datum</th>';
echo '<th>Plaats</th>';

if ($recht == 3) {
    echo '<th>Beheren</th>';
    //echo '<td>' . anchor('admin/evenementToevoegen/', "Nieuw evenement", "class='buttons'") . '</td>';
} else if ($recht == 1) {
    echo '<th>Inschrijven</th>';
} else {
    echo '<th>Beheren</th>';
    echo '<th>Inschrijven</th>';
}
/* echo '</tr>';
  echo '<tr>';
  echo '<th></th>';
  echo '<th></th>';
  echo '<th></th>';
  echo '</tr>'; */
echo '</thead>';
echo '<tbody>';
foreach ($evenementen as $evenement) {
    echo '<tr>';
    //, $id = $evenement->id, $naam = $evenement->naam
    echo '<td>' . divAnchor('alumnus/evenementdetail/' . $evenement->id, $evenement->naam) . '</td>';
    echo '<td>' . strftime("%d/%m/%Y", strtotime($evenement->begintijd)) . '</td>';
    echo '<td>' . $evenement->plaats->locatie . '</td>';

    //controle op gebruiker en naargelang juiste knop aanbieden
    if ($recht == 3) {
//            //Knoppen voor editten en verwijderen
        echo '<td>' . anchor('admin/evenementAanpassen/' . $evenement->id, 
                '<div class="ui-icon ui-icon-pencil"></div>',  'title="Bewerken"');
        echo '<a class="verwijder" id="' . $evenement->id . '" name="' . $evenement->naam . '">' . anchor('#', 
                '<div class="ui-icon ui-icon-close"></div>',  'title="Verwijderen"') . '</a></td>';
    } elseif ($recht == 1) {
//            //indien een gewone alumnus => zichzelf kunnen inschrijven
           echo '<td>' . anchor('alumnus/inschrijven/' . $evenement->id, $actie, "class='buttons'") . '</td>';
    } elseif ($recht == 2) {
//            //docenten mogen aanpassen en inschrijven
//            echo '<td>' . anchor('admin/evenementAanpassen/' . $evenement->id, '<img src="' . base_url() . APPPATH . 'css/images/edit.png"/>') . '</td>';
//            echo '<td>' . anchor('alumnus/inschrijven/' . $evenement->id, "In- Uitschrijven", "class='buttons'") . '</td>';
    }
    echo '</tr>';
}
echo '</tbody>';
echo '<tfoot>';
echo '<tr>';
echo '<th></th>';
echo '<th></th>';
echo '<th></th>';
echo '</tr>';
echo '</tfoot>';
echo "</table>";
?>